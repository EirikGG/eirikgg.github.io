<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Smart city</title>
        <style>
            body {margin:0;}
            canvas {display: block;}
        </style>
        <script src="lib/three.min.js"></script>
        <script src="lib/OrbitControls.js"></script>
        <script src="lib/OBJLoader.js"></script>
        <script src="lib/GLTFExporter.js"></script>
        <script src="lib/GLTFLoader.js"></script>
        

        <link rel="stylesheet" href="./misc/navBar.css">

    </head>
    <body onload="setup()">

        <div class="navbar">
            <div class="dropdown">
                <div class="dropbtn">Scene
                </div>
                <div class="dropdown-content">
                    <a onclick="javascript: newEnvironment('models/stavanger/stavanger.glb')">Stavanger</a>
                    <a onclick="javascript: newEnvironment('models/matterhorn/matterhorn.glb')">Matterhorn</a>
                </div>
            </div>

            <a onclick="javascript: sceneSave();">Save scene</a>
            <a id="loadScene">Load scene</a>
            <form id='formid' method="POST" enctype="multipart/form-data"> 
                <input id='fileid' type='file' onchange="handleFile(event);" hidden/>
            </form> 

            <div class="dropdown">
                <div id="cancelBuildingBtn" onclick="javascript: buildingCancel(); addBuildingPassive()" class="dropbtn"> Add building
                </div>
                <div class="dropdown-content">
                    <a onclick="javascript: buildingFarmHouse(); addBuildingActive();">Farmhouse</a>
                    <a onclick="javascript: cityBuilding(); addBuildingActive();">City building 1</a>
                    <a onclick="javascript: cityBuilding2(); addBuildingActive();">City building 2</a>
                    <a onclick="javascript: cityBuilding3(); addBuildingActive();">City building 3</a>
                    <a onclick="javascript: cityBuilding4(); addBuildingActive();">City building 4</a>
                </div>
            </div>
            <a id="deleteBtn" onclick="javascript: buildingDelete(); doDeleteActive()">Delete building</a>

            
            <a id="landmark" onclick=" javascript: toggleLandmark(); handleLandmark();">Select landmark</a>

            <a id="landvis" onclick=" javascript: landmarkVis();">Landmark visability</a>
            
            <a id="skyVis" onclick=" javascript: toggleSkyVis(); handleSkyVis();">Sky visability</a>
                  
            <a id="landvisClear" onclick=" javascript: removeLine();">Clear lines</a>

            <a id="addBars" onclick=" javascript: toggleBars(); handleBars();">Add bars</a>

            <a id="stopBars" onclick=" javascript: removeBars(); ">Remove bars</a>

            
            <script>
                function addBuildingActive() {
                  var x = document.getElementById("cancelBuildingBtn");
                  x.innerHTML = "Cancel";
                }
                function addBuildingPassive() {
                  var x = document.getElementById("cancelBuildingBtn");
                  x.innerHTML = "Add building";
                }
                function doDeleteActive() {
                    var x = document.getElementById("deleteBtn");
                    if("Delete building" === x.innerHTML) {
                        x.innerHTML = "Cancel";
                    } else {
                        x.innerHTML = "Delete building";
                    }
                }
                function setup() {
                    document.getElementById('loadScene').addEventListener('click', openDialog);
                    function openDialog() {
                        document.getElementById('fileid').click();
                    }
                }
                function handleFile(event) {
                    var file = document.getElementById("fileid").files[0];
                    if (file) {
                        var reader = new FileReader();
                        reader.readAsText(file, "UTF-8");
                        reader.onload = function (evt) {
                            sceneLoad(evt.target.result);
                        }
                    }
                }
                function handleSkyVis() {
                    var x = document.getElementById("skyVis");
                    if("Sky visability" === x.innerHTML) {
                        x.innerHTML = "Cancel";
                    } else {
                        x.innerHTML = "Sky visability";
                    }
                }
                function handleLandmark() {
                    var x = document.getElementById("landmark");
                    if("Select landmark" === x.innerHTML) {
                        x.innerHTML = "Confirm";
                    } else {
                        x.innerHTML = "Select landmark";
                        indicateLandmark();
                    }
                }
                function handleBars() {
                    var x = document.getElementById("addBars");
                    if("Add bars" === x.innerHTML) {
                        x.innerHTML = "Cancel";
                    } else {
                        x.innerHTML = "Add bars";
                    }
                }
                </script>
                    

        <script src="city.js" type="text/javascript"></script>
        </div>
    </body>
</html>